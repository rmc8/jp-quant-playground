# jp-quant-playground

æ—¥æœ¬æ ªã®ã‚¯ã‚ªãƒ³ãƒ„æˆ¦ç•¥ã‚’å®Ÿé¨“ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã€‚ãƒ•ã‚¡ãƒ³ãƒ€ãƒ¡ãƒ³ã‚¿ãƒ«æŒ‡æ¨™ã‚’çµ„ã¿åˆã‚ã›ã¦ã€å¸‚å ´ã‚’è¶…ãˆã‚‹ãƒªã‚¿ãƒ¼ãƒ³ã‚’ç›®æŒ‡ã™ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆç’°å¢ƒã€‚

## ğŸ“Š CSVå‡ºåŠ›åˆ—ã®è©³ç´°

yfinanceãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ãŒå‡ºåŠ›ã™ã‚‹å…¨32åˆ—ã®è©³ç´°æƒ…å ±ã§ã™ã€‚

| åˆ—å | åŒºåˆ† | èª¬æ˜ | é–¢é€£æŒ‡æ¨™ | æˆé•·æ ªæŠ•è³‡ | é«˜é…å½“æ ªæŠ•è³‡ | å‰²å®‰æ ªæŠ•è³‡ |
|------|------|------|----------|------------|-------------|------------|
| **ticker** | è­˜åˆ¥æƒ…å ± | è¨¼åˆ¸ã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹ï¼š7203ï¼‰ | - | - | - | - |
| **stock_name** | ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ | éŠ˜æŸ„åï¼ˆæ—¥æœ¬èªï¼‰ | - | - | - | - |
| **market_category** | ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ | å¸‚å ´åŒºåˆ†ï¼ˆãƒ—ãƒ©ã‚¤ãƒ ã€ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã€ã‚°ãƒ­ãƒ¼ã‚¹ç­‰ï¼‰ | - | â—‹ | - | - |
| **sector_33** | ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ | 33æ¥­ç¨®åŒºåˆ† | - | â—‹ | â—‹ | â—‹ |
| **sector_17** | ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ | 17æ¥­ç¨®åŒºåˆ† | - | â—‹ | â—‹ | â—‹ |
| **dividend_yield** | é…å½“æŒ‡æ¨™ | é…å½“åˆ©å›ã‚Šï¼ˆ%ï¼‰<br>å¹´é–“é…å½“é‡‘ / æ ªä¾¡ | payout_ratio | - | â— | â—‹ |
| **payout_ratio** | é…å½“æŒ‡æ¨™ | é…å½“æ€§å‘ï¼ˆ%ï¼‰<br>é…å½“é‡‘ / ç´”åˆ©ç›Š | dividend_yield | - | â— | â—‹ |
| **earnings_y0** | åˆ©ç›Šãƒ‡ãƒ¼ã‚¿ | å½“æœŸç´”åˆ©ç›Šï¼ˆç›´è¿‘å¹´ï¼‰ | earnings_y1, y2 | â— | â— | â—‹ |
| **earnings_y1** | åˆ©ç›Šãƒ‡ãƒ¼ã‚¿ | å½“æœŸç´”åˆ©ç›Šï¼ˆå‰å¹´ï¼‰ | earnings_y0, y2 | â— | â— | â—‹ |
| **earnings_y2** | åˆ©ç›Šãƒ‡ãƒ¼ã‚¿ | å½“æœŸç´”åˆ©ç›Šï¼ˆå‰ã€…å¹´ï¼‰ | earnings_y0, y1 | â— | â— | â—‹ |
| **consecutive_earnings_growth** | åˆ©ç›Šãƒ‡ãƒ¼ã‚¿ | 3å¹´é€£ç¶šå¢—ç›Šãƒ•ãƒ©ã‚°<br>earnings_y0 > y1 > y2 | earnings_y0/y1/y2 | â— | â— | â—‹ |
| **trailing_pe** | ãƒãƒªãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ | å®Ÿç¸¾PERï¼ˆæ ªä¾¡åç›Šç‡ï¼‰<br>æ ªä¾¡ / 1æ ªå½“ãŸã‚Šåˆ©ç›Š | peg_ratio, ev_ebit | - | â—‹ | â— |
| **psr** | ãƒãƒªãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ | PSRï¼ˆæ ªä¾¡å£²ä¸Šé«˜å€ç‡ï¼‰<br>æ™‚ä¾¡ç·é¡ / å£²ä¸Šé«˜ | trailing_pe, peg_ratio | â—‹ | - | â— |
| **peg_ratio** | ãƒãƒªãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ | PEGãƒ¬ã‚·ã‚ª<br>PER / åˆ©ç›Šæˆé•·ç‡ï¼ˆ%ï¼‰ | trailing_pe, earnings_growth | â— | - | â— |
| **market_cap** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | æ™‚ä¾¡ç·é¡ï¼ˆå††ï¼‰ | enterprise_value | â—‹ | â—‹ | â—‹ |
| **total_cash** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | ç¾é‡‘åŠã³ç¾é‡‘åŒç­‰ç‰©ï¼ˆå††ï¼‰ | total_debt, net_cash_ratio | - | â—‹ | â—‹ |
| **total_debt** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | æœ‰åˆ©å­è² å‚µåˆè¨ˆï¼ˆå††ï¼‰ | total_cash, enterprise_value | - | â—‹ | â—‹ |
| **total_assets** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | ç·è³‡ç”£ï¼ˆå††ï¼‰ | book_value, gross_profitability | - | â—‹ | â—‹ |
| **book_value** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | æ ªä¸»è³‡æœ¬ï¼ˆè‡ªå·±è³‡æœ¬ï¼‰ï¼ˆå††ï¼‰ | pbr, total_assets | - | â—‹ | â— |
| **operating_cash_flow** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | å–¶æ¥­ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼ï¼ˆå††ï¼‰ | capex, fcf_yield, ev_fcf | â—‹ | â— | â— |
| **capex** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | è¨­å‚™æŠ•è³‡é¡ï¼ˆè³‡æœ¬çš„æ”¯å‡ºï¼‰ï¼ˆå††ï¼‰<br>â€»é€šå¸¸ã¯è² ã®å€¤ | operating_cash_flow, fcf_yield | - | â—‹ | â—‹ |
| **ebit** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | EBITï¼ˆåˆ©æ‰•ã„ãƒ»ç¨å¼•ãå‰åˆ©ç›Šï¼‰ï¼ˆå††ï¼‰ | ev_ebit, net_income | â—‹ | â—‹ | â—‹ |
| **gross_profit** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | å£²ä¸Šç·åˆ©ç›Šï¼ˆå††ï¼‰ | gross_profitability, total_revenue | â—‹ | â—‹ | â—‹ |
| **net_income** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | å½“æœŸç´”åˆ©ç›Šï¼ˆå††ï¼‰ | earnings_y0, trailing_pe | â— | â— | â—‹ |
| **total_revenue** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | å£²ä¸Šé«˜ï¼ˆå††ï¼‰ | psr, gross_profit | â—‹ | â—‹ | â—‹ |
| **earnings_growth** | è²¡å‹™ãƒ‡ãƒ¼ã‚¿ | åˆ©ç›Šæˆé•·ç‡ï¼ˆå°æ•°ã€0.15=15%ï¼‰ | peg_ratio, consecutive_earnings_growth | â— | â—‹ | â—‹ |
| **net_cash_ratio** | è¨ˆç®—æŒ‡æ¨™ | ãƒãƒƒãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¯”ç‡<br>(ç¾é‡‘ - è² å‚µ) / æ™‚ä¾¡ç·é¡ | total_cash, total_debt | - | â— | â— |
| **enterprise_value** | è¨ˆç®—æŒ‡æ¨™ | ä¼æ¥­ä¾¡å€¤ï¼ˆEVï¼‰<br>æ™‚ä¾¡ç·é¡ + ç´”æœ‰åˆ©å­è² å‚µ | market_cap, total_debt, total_cash | - | - | â—‹ |
| **gross_profitability** | è¨ˆç®—æŒ‡æ¨™ | å£²ä¸Šç·åˆ©ç›Šç‡<br>å£²ä¸Šç·åˆ©ç›Š / ç·è³‡ç”£ | gross_profit, total_assets | â—‹ | â—‹ | â— |
| **fcf_yield** | è¨ˆç®—æŒ‡æ¨™ | FCFåˆ©å›ã‚Š<br>ãƒ•ãƒªãƒ¼CF / æ™‚ä¾¡ç·é¡ | operating_cash_flow, capex | â—‹ | â— | â— |
| **pbr** | è¨ˆç®—æŒ‡æ¨™ | PBRï¼ˆæ ªä¾¡ç´”è³‡ç”£å€ç‡ï¼‰<br>æ™‚ä¾¡ç·é¡ / æ ªä¸»è³‡æœ¬ | book_value, market_cap | - | â—‹ | â— |
| **ev_ebit** | è¨ˆç®—æŒ‡æ¨™ | EV/EBITå€ç‡<br>ä¼æ¥­ä¾¡å€¤ / EBIT | enterprise_value, ebit | - | - | â— |
| **ev_fcf** | è¨ˆç®—æŒ‡æ¨™ | EV/FCFå€ç‡<br>ä¼æ¥­ä¾¡å€¤ / ãƒ•ãƒªãƒ¼CF | enterprise_value, fcf_yield | - | â—‹ | â— |

### å‡¡ä¾‹

- **æˆé•·æ ªæŠ•è³‡**: â— éå¸¸ã«æœ‰ç”¨ / â—‹ æœ‰ç”¨ / - é–¢é€£æ€§ä½ã„
- **é«˜é…å½“æ ªæŠ•è³‡**: â— éå¸¸ã«æœ‰ç”¨ / â—‹ æœ‰ç”¨ / - é–¢é€£æ€§ä½ã„
- **å‰²å®‰æ ªæŠ•è³‡**: â— éå¸¸ã«æœ‰ç”¨ / â—‹ æœ‰ç”¨ / - é–¢é€£æ€§ä½ã„

### åŒºåˆ†ã®èª¬æ˜

- **è­˜åˆ¥æƒ…å ±**: éŠ˜æŸ„ã‚’ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹ãŸã‚ã®æƒ…å ±
- **ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿**: éŠ˜æŸ„ã®å±æ€§æƒ…å ±ï¼ˆåç§°ã€å¸‚å ´ã€æ¥­ç¨®ï¼‰
- **é…å½“æŒ‡æ¨™**: é…å½“æŠ•è³‡ãƒ»ã‚¤ãƒ³ã‚«ãƒ ã‚²ã‚¤ãƒ³æˆ¦ç•¥ã«ä½¿ç”¨
- **åˆ©ç›Šãƒ‡ãƒ¼ã‚¿**: åˆ©ç›Šæˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰ã®æŠŠæ¡ã«ä½¿ç”¨
- **ãƒãƒªãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³**: æ ªä¾¡ã®å‰²é«˜ãƒ»å‰²å®‰åˆ¤æ–­ã«ä½¿ç”¨
- **è²¡å‹™ãƒ‡ãƒ¼ã‚¿**: yfinanceã‹ã‚‰ç›´æ¥å–å¾—ã—ãŸç”Ÿãƒ‡ãƒ¼ã‚¿
- **è¨ˆç®—æŒ‡æ¨™**: è²¡å‹™ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è¨ˆç®—ã—ãŸé«˜åº¦ãªæŠ•è³‡æŒ‡æ¨™

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync
```

### ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

```bash
# å…¨éŠ˜æŸ„ï¼ˆå€‹åˆ¥æ ªã®ã¿ã€ç´„4,000éŠ˜æŸ„ï¼‰ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
uv run python -m note.scripts.export_stock_data

# æœ€åˆã®100éŠ˜æŸ„ã®ã¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
uv run python -m note.scripts.export_stock_data --limit 100

# ETF/ETNã‚‚å«ã‚ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
uv run python -m note.scripts.export_stock_data --include-etf

# ã‚«ã‚¹ã‚¿ãƒ å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»å‡ºåŠ›å…ˆã‚’æŒ‡å®š
uv run python -m note.scripts.export_stock_data \
  --input path/to/tickers.tsv \
  --output path/to/output/
```

### å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ `note/data/exports/stock_data_YYYYMMDD_HHMMSS.csv` ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

## ğŸ“ˆ æŠ•è³‡æˆ¦ç•¥ã®ä¾‹

### é«˜é…å½“æ ªã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°

ä»¥ä¸‹ã®æ¡ä»¶ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼š
- `dividend_yield >= 0.04` (é…å½“åˆ©å›ã‚Š4%ä»¥ä¸Š)
- `payout_ratio < 0.6` (é…å½“æ€§å‘60%æœªæº€ã€é…å½“ä½™åŠ›ã‚ã‚Š)
- `consecutive_earnings_growth == True` (3å¹´é€£ç¶šå¢—ç›Š)
- `net_cash_ratio > 0` (ãƒãƒƒãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€è²¡å‹™å®‰å…¨)

### å‰²å®‰æˆé•·æ ªã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°

ä»¥ä¸‹ã®æ¡ä»¶ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼š
- `peg_ratio < 1.0` (PEGãƒ¬ã‚·ã‚ª1æœªæº€ã€æˆé•·æ€§ã«å¯¾ã—ã¦å‰²å®‰)
- `pbr < 1.5` (PBR1.5æœªæº€)
- `ev_ebit < 10` (EV/EBIT 10å€æœªæº€)
- `earnings_growth > 0.1` (åˆ©ç›Šæˆé•·ç‡10%ä»¥ä¸Š)
- `gross_profitability > 0.35` (å£²ä¸Šç·åˆ©ç›Šç‡35%ä»¥ä¸Šã€é«˜åç›Šæ€§)

### ãƒãƒªãƒ¥ãƒ¼æ ªã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°

ä»¥ä¸‹ã®æ¡ä»¶ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼š
- `trailing_pe < 15` (PER15å€æœªæº€)
- `pbr < 1.0` (PBR1å€æœªæº€ã€è§£æ•£ä¾¡å€¤ä»¥ä¸‹)
- `fcf_yield > 0.05` (FCFåˆ©å›ã‚Š5%ä»¥ä¸Š)
- `net_cash_ratio > 0.1` (ãƒãƒƒãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¯”ç‡10%ä»¥ä¸Š)
- `ev_ebit < 8` (EV/EBIT 8å€æœªæº€)

## ğŸ›  é–‹ç™º

### ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯

```bash
# ãƒªãƒ³ã‚¿ãƒ¼å®Ÿè¡Œ
uv run ruff check .

# ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®Ÿè¡Œ
uv run ruff format .

# ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ•´ç†
uv run isort .
```

## ğŸ“š è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

è©³ç´°ãªé–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ [CLAUDE.md](./CLAUDE.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯å€‹äººçš„ãªå®Ÿé¨“ãƒ»å­¦ç¿’ç›®çš„ã§ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚

## Speckit

```mermaid
flowchart TD
    Start([é–‹å§‹]) --> Constitution["speckit.constitution<br/>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ–¹é‡å®šç¾©"]
    
    Constitution --> Specify["speckit.specify<br/>è¦ä»¶å®šç¾©"]
    
    Specify --> ClarifyCheck{"è¦ä»¶ãŒä¸æ˜ç­?"}
    ClarifyCheck -->|ã¯ã„| Clarify["speckit.clarify<br/>(ã‚ªãƒ—ã‚·ãƒ§ãƒ³)<br/>è¦ä»¶ã®æ˜ç¢ºåŒ–"]
    ClarifyCheck -->|ã„ã„ãˆ| Plan
    Clarify --> Plan
    
    Plan["speckit.plan<br/>æŠ€è¡“è¨ˆç”»ç­–å®š"]
    
    Plan --> ChecklistCheck{"å“è³ªæ¤œè¨¼å¿…è¦?"}
    ChecklistCheck -->|ã¯ã„| Checklist["speckit.checklist<br/>(ã‚ªãƒ—ã‚·ãƒ§ãƒ³)<br/>å“è³ªãƒã‚§ãƒƒã‚¯"]
    ChecklistCheck -->|ã„ã„ãˆ| Tasks
    Checklist --> Tasks
    
    Tasks["speckit.tasks<br/>ã‚¿ã‚¹ã‚¯åˆ†è§£"]
    
    Tasks --> AnalyzeCheck{"æ•´åˆæ€§è§£æå¿…è¦?"}
    AnalyzeCheck -->|ã¯ã„| Analyze["speckit.analyze<br/>(ã‚ªãƒ—ã‚·ãƒ§ãƒ³)<br/>æ•´åˆæ€§è§£æ"]
    AnalyzeCheck -->|ã„ã„ãˆ| Implement
    Analyze --> Implement
    
    Implement["speckit.implement<br/>TDDå®Ÿè£…"]
    
    Implement --> End([å®Œäº†])
    
    style Constitution fill:#4A90E2,stroke:#2E5C8A,color:#fff
    style Specify fill:#4A90E2,stroke:#2E5C8A,color:#fff
    style Plan fill:#4A90E2,stroke:#2E5C8A,color:#fff
    style Tasks fill:#4A90E2,stroke:#2E5C8A,color:#fff
    style Implement fill:#4A90E2,stroke:#2E5C8A,color:#fff
    
    style Clarify fill:#F5A623,stroke:#C77E0A,color:#fff
    style Checklist fill:#F5A623,stroke:#C77E0A,color:#fff
    style Analyze fill:#F5A623,stroke:#C77E0A,color:#fff
```